{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios'\n\nconst API_KEY = '36979931-b9ebd2c49fac6caefdf5e0dc3'\nconst BASE_URL = 'https://pixabay.com/api/'\n\nasync function getImagesByQuery(query, page = 1) {\n\ttry {\n\t\tconst response = await axios.get(BASE_URL, {\n\t\t\tparams: {\n\t\t\t\tkey: API_KEY,\n\t\t\t\tq: query,\n\t\t\t\timage_type: 'photo',\n\t\t\t\torientation: 'horizontal',\n\t\t\t\tsafesearch: true,\n\t\t\t\tpage: page,\n\t\t\t\tper_page: 15,\n\t\t\t},\n\t\t})\n\t\treturn response.data\n\t} catch (error) {\n\t\tthrow new Error('Failed to fetch images')\n\t}\n}\n\nexport { getImagesByQuery }\n","import SimpleLightbox from 'simplelightbox'\nimport 'simplelightbox/dist/simple-lightbox.min.css'\n\nconst imageGallery = document.querySelector('.image-gallery')\nconst spinner = document.querySelector('.spinner')\nconst loadMoreBtn = document.querySelector('.load-more-btn')\n\nlet lightbox = null\n\nfunction createLightbox() {\n\t// Уничтожаем предыдущий экземпляр если он существует\n\tif (lightbox) {\n\t\tlightbox.destroy()\n\t}\n\n\t// Создаем новый экземпляр SimpleLightbox\n\tlightbox = new SimpleLightbox('.gallery-link', {\n\t\tcaptionsData: 'alt',\n\t\tcaptionPosition: 'bottom',\n\t\tcaptionDelay: 250,\n\t})\n}\n\nfunction createGallery(images) {\n\tconst markup = images\n\t\t.map(\n\t\t\t({\n\t\t\t\twebformatURL,\n\t\t\t\tlargeImageURL,\n\t\t\t\ttags,\n\t\t\t\tlikes,\n\t\t\t\tviews,\n\t\t\t\tcomments,\n\t\t\t\tdownloads,\n\t\t\t}) => `<li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${largeImageURL}\">\n        <div class=\"image-container\">\n          <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" />\n        </div>\n        <div class=\"image-inform\">\n          <div>\n            <h3 class=\"image-inform-title\">Likes</h3>\n            <span class=\"image-inform-text\">${likes}</span>\n          </div>\n          <div>\n            <h3 class=\"image-inform-title\">Views</h3>\n            <span class=\"image-inform-text\">${views}</span>\n          </div>\n          <div>\n            <h3 class=\"image-inform-title\">Comments</h3>\n            <span class=\"image-inform-text\">${comments}</span>\n          </div>\n          <div>\n            <h3 class=\"image-inform-title\">Downloads</h3>\n            <span class=\"image-inform-text\">${downloads}</span>\n          </div>\n        </div>\n      </a>\n    </li>`\n\t\t)\n\t\t.join('')\n\n\timageGallery.insertAdjacentHTML('beforeend', markup)\n\tcreateLightbox()\n}\n\nfunction clearGallery() {\n\timageGallery.innerHTML = ''\n\tif (lightbox) {\n\t\tlightbox.destroy()\n\t\tlightbox = null\n\t}\n}\n\nfunction showLoader() {\n\tspinner.classList.remove('hidden')\n}\n\nfunction hideLoader() {\n\tspinner.classList.add('hidden')\n}\n\nfunction showLoadMoreButton() {\n\tloadMoreBtn.style.display = 'block'\n}\n\nfunction hideLoadMoreButton() {\n\tloadMoreBtn.style.display = 'none'\n}\n\nexport {\n\tclearGallery,\n\tcreateGallery,\n\thideLoadMoreButton,\n\thideLoader,\n\tshowLoadMoreButton,\n\tshowLoader,\n}\n","import iziToast from 'izitoast'\nimport 'izitoast/dist/css/iziToast.min.css'\n\nimport { getImagesByQuery } from './js/pixabay-api.js'\nimport {\n\tclearGallery,\n\tcreateGallery,\n\thideLoader,\n\thideLoadMoreButton,\n\tshowLoader,\n\tshowLoadMoreButton,\n} from './js/render-functions.js'\n\nconst searchForm = document.querySelector('.search-form')\nconst loadMoreBtn = document.querySelector('.load-more-btn')\n\nlet currentQuery = ''\nlet currentPage = 1\nlet totalHits = 0\n\n// Скрываем кнопку Load more при загрузке\nhideLoadMoreButton()\n\nsearchForm.addEventListener('submit', handleSearch)\nloadMoreBtn.addEventListener('click', handleLoadMore)\n\nasync function handleSearch(event) {\n\tevent.preventDefault()\n\n\tconst searchQuery = event.target.elements['search-text'].value.trim()\n\n\tif (!searchQuery) {\n\t\tiziToast.error({\n\t\t\tmessage: 'Please enter some valid search value!',\n\t\t\tmessageSize: '16px',\n\t\t\tmessageLineHeight: '24px',\n\t\t\tmessageColor: '#fafafb',\n\t\t\tcloseOnClick: true,\n\t\t\tposition: 'topRight',\n\t\t})\n\t\treturn\n\t}\n\n\t// Сброс при новом поиске\n\tcurrentQuery = searchQuery\n\tcurrentPage = 1\n\tclearGallery()\n\thideLoadMoreButton()\n\n\ttry {\n\t\tshowLoader()\n\t\tconst data = await getImagesByQuery(searchQuery, currentPage)\n\n\t\tif (data.hits.length === 0) {\n\t\t\tiziToast.error({\n\t\t\t\tmessage:\n\t\t\t\t\t'Sorry, there are no images matching your search query. Please try again!',\n\t\t\t\tmessageSize: '16px',\n\t\t\t\tmessageLineHeight: '24px',\n\t\t\t\tmessageColor: '#fafafb',\n\t\t\t\tcloseOnClick: true,\n\t\t\t\tposition: 'topRight',\n\t\t\t})\n\t\t\treturn\n\t\t}\n\n\t\ttotalHits = data.totalHits\n\t\tcreateGallery(data.hits)\n\n\t\t// Показываем кнопку Load more только если есть еще страницы\n\t\tif (data.hits.length < totalHits) {\n\t\t\tshowLoadMoreButton()\n\t\t}\n\n\t\t// Показываем сообщение о количестве найденных изображений\n\t\tiziToast.success({\n\t\t\tmessage: `Hooray! We found ${totalHits} images.`,\n\t\t\tmessageSize: '16px',\n\t\t\tmessageLineHeight: '24px',\n\t\t\tmessageColor: '#fafafb',\n\t\t\tcloseOnClick: true,\n\t\t\tposition: 'topRight',\n\t\t})\n\t} catch (error) {\n\t\tiziToast.error({\n\t\t\tmessage: `${error.message}. Please try again later`,\n\t\t\tcloseOnClick: true,\n\t\t\tposition: 'topRight',\n\t\t})\n\t} finally {\n\t\thideLoader()\n\t\tsearchForm.reset()\n\t}\n}\n\nasync function handleLoadMore() {\n\tif (!currentQuery) return\n\n\tcurrentPage += 1\n\n\ttry {\n\t\tshowLoader()\n\t\tconst data = await getImagesByQuery(currentQuery, currentPage)\n\n\t\tcreateGallery(data.hits)\n\n\t\t// Проверяем, есть ли еще страницы\n\t\tconst totalPages = Math.ceil(totalHits / 15)\n\t\tif (currentPage >= totalPages) {\n\t\t\thideLoadMoreButton()\n\t\t\tiziToast.info({\n\t\t\t\tmessage: \"We're sorry, but you've reached the end of search results.\",\n\t\t\t\tmessageSize: '16px',\n\t\t\t\tmessageLineHeight: '24px',\n\t\t\t\tmessageColor: '#fafafb',\n\t\t\t\tcloseOnClick: true,\n\t\t\t\tposition: 'topRight',\n\t\t\t})\n\t\t}\n\t} catch (error) {\n\t\tiziToast.error({\n\t\t\tmessage: `${error.message}. Please try again later`,\n\t\t\tcloseOnClick: true,\n\t\t\tposition: 'topRight',\n\t\t})\n\t\tcurrentPage -= 1 // Откатываем номер страницы при ошибке\n\t} finally {\n\t\thideLoader()\n\t}\n}\n"],"names":["API_KEY","BASE_URL","getImagesByQuery","query","page","axios","imageGallery","spinner","loadMoreBtn","lightbox","createLightbox","SimpleLightbox","createGallery","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","searchForm","currentQuery","currentPage","totalHits","handleSearch","handleLoadMore","event","searchQuery","iziToast","data","error","totalPages"],"mappings":"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"}